<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agregar Corrida</title>
    <link rel="stylesheet" href="../estilos.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
  <div class="header">
      <img src="../img/ADO-Autobuses-de-Oriente-Logo-700x394.png" alt="ADO Logo">
      <div class="nav-links">
        <a href="index1.html">Inicio</a>
        <a href="../index.html" id="logoutButton" name="logoutButton" class="logout-button">Cerrar Sesión</a>
      </div>  
  </div>
    <main class="main">
        <section class="form">
            <h2 class="form__title">Agregar Corrida</h2>
            <form class="form__content" id="corridaForm">
                <div class="form__group">
                    <label for="autobus"  class="form__label" style="display: flex; width: 100%;">
                        <i class="fas fa-bus"></i>
                        <pre> </pre>
                        <span>Autobús:</span>
                    </label>
                    <input type="text" id="autobus" class="form__input" placeholder="Número de autobús" required />
                </div>
                <div class="form__group">
                    <label for="origen" class="form__label" style="display: flex; width: 100%;">
                        <i class="fas fa-map-marker-alt"></i>
                        <pre> </pre>
                        <span>Origen:</span>
                        
                    </label>
                    <input type="text" id="origen" class="form__input" placeholder="Ciudad de origen" required />
                </div>
                <div class="form__group">
                    <label for="destino" class="form__label" style="display: flex;  width: 100%;">
                        <i class="fas fa-flag-checkered"></i>
                        <pre> </pre>
                        <span>Destino:</span>
                        
                    </label>
                    <input type="text" id="destino" class="form__input" placeholder="Ciudad de destino" required />
                </div>
                <div class="form__group">
                    <label for="fecha" class="form__label" style="display: flex;  width: 100%;">
                        <i class="fas fa-calendar-alt"></i>
                        <pre> </pre>
                        <span>Fecha:</span>
                    </label>
                    <input type="date" id="fecha" class="form__input" 
                    style="
                      -webkit-appearance: none !important;
                      -moz-appearance: none !important;
                      appearance: none !important;
                      padding: 12px 15px !important;
                      border-radius: 5px !important;
                      border: 1px solid #ddd !important;
                      width: 100% !important;
                      box-sizing: border-box !important;
                      font-family: Arial, sans-serif !important;
                      font-size: 16px !important;
                    " required />
                </div>
                <div class="form__group">
                    <label for="horaSalida" class="form__label" style="display: flex;  width: 100%;">
                        <i class="fas fa-clock"></i>
                        <pre> </pre>
                        <span>Hora de salida:</span>
                    </label>
                    <input type="time" id="horaSalida" class="form__input" 
                    style="
                      -webkit-appearance: none !important;
                      -moz-appearance: none !important;
                      appearance: none !important;
                      padding: 12px 15px !important;
                      border-radius: 5px !important;
                      border: 1px solid #ddd !important;
                      width: 100% !important;
                      box-sizing: border-box !important;
                      font-family: Arial, sans-serif !important;
                      font-size: 16px !important;
                    " required />
                    
                </div>
                <div class="form__group">
                    <label for="horaLlegada" class="form__label" style="display: flex;  width: 100%;">
                        <i class="fas fa-clock"></i>
                        <pre> </pre>
                        <span>Hora estimada de llegada:</span>
                    </label>
                    
                </div>
                <div class="form__group">
                    <label for="tipoCorrida" class="form__label" style="display: flex; width: 100%;">
                        <i class="fas fa-route"></i>
                        <pre> </pre>
                        <span>Tipo de corrida:</span>
                    </label>
                    <select id="tipoCorrida" class="form__select" required>
                        <option value="" disabled selected>Seleccione el tipo</option>
                        <option value="1">Intermedia</option>
                        <option value="2">Directa</option>
                    </select>
                </div>
                <div class="form__group">
                    <label for="asientos" class="form__label" style="display: flex;  width: 100%;">
                        <i class="fas fa-chair"></i>
                        <pre> </pre>
                        <span>Asientos disponibles:</span>
                    </label>
                    <input type="number" id="asientos" class="form__input" placeholder="Número de asientos" style="
            -webkit-appearance: none !important;
            -moz-appearance: none !important;
            appearance: none !important;
            padding: 12px 15px !important;
            border-radius: 5px !important;
            border: 1px solid #ddd !important;
            width: 100% !important;
            box-sizing: border-box !important;
            font-family: Arial, sans-serif !important;
            font-size: 16px !important;"required/>
                </div>
                <div class="form__group">
                    <label for="precio" class="form__label" style="display: flex;  width: 100%;">
                        <i class="fas fa-dollar-sign"></i>
                        <pre> </pre>
                        <span>Precio:</span>
                        <input 
                        type="number" 
                        id="precio" 
                        class="form__input" 
                        placeholder="Precio del boleto" 
                        style="
                            -webkit-appearance: none !important;
                            -moz-appearance: none !important;
                            appearance: none !important;
                            padding: 12px 15px !important;
                            border-radius: 5px !important;
                            border: 1px solid #ddd !important;
                            width: 100% !important;
                            box-sizing: border-box !important;
                            font-family: Arial, sans-serif !important;
                            font-size: 16px !important;"required/>
                </div>
                <button type="submit" class="form__button">Guardar Corrida</button>
            </form>
        </section>
    </main>
    <script>
        document.getElementById('autobusForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = {
            id: document.getElementById('id').value,
            numero: document.getElementById('numero').value,
            capacidad: parseInt(document.getElementById('asientos').value),
            servicios: document.getElementById('servicios').value,
            numeroIncidentes: parseInt(document.getElementById('incidentes').value),
            estado: document.getElementById('estado').value.toUpperCase()
        };
    
        const token = localStorage.getItem('token');
        
        fetch("http://127.0.0.1:8000.com/api/autobuses", {
            method: "POST",
            headers: {
                "Authorization": `Bearer ${token}`,
                "Content-Type": "application/json"
            },
            body: JSON.stringify(formData)
        })
        .then(response => {
            if (!response.ok) throw new Error('Error al crear autobús');
            return response.json();
        })
        .then(data => {
            alert('Autobús creado exitosamente!');
            window.location.href = 'lista_autobuses.html';
        })
        .catch(error => {
            console.error("Error:", error);
            alert('Error al crear el autobús: ' + error.message);
        });
    });
    </script>
</body>
</html>